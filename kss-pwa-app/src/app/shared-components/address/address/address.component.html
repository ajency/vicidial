<div *ngIf="addresses">
	<form #myForm="ngForm">
		<div class="shipping-content" *ngIf="addAddress">
			<div class="">
				<h3 class="">Shipping Information</h3>
			</div>
			<p class="sub-text w-75 mt-3">Enter the address where your items will be shipped</p>
			<div class="row">
				<div class="col-md-12">
					<div class="form-group ">
						<input class="form-control form-control-lg" id="names" type="text" name="name" [(ngModel)]="newAddress.name" required [ngClass]="{'has-value' : newAddress.name}" (ngModelChange)="copyUserName(newAddress.pincode)">
						<label class="control-label">Full Name <span class="pl-1 text-danger">*</span></label>
					</div>
				</div>
				<div class="col-md-12">
					<div class="form-group" [ngClass]="{'has-error' : newAddress.phone<6000000000 && newAddress.phone.length== 10 }">
						<input class="form-control form-control-lg" id="mobile" type="tel" minlength = "10" maxlength = "10" pattern="^[6789]\d{9}$" inputmode="numeric" name="mobile" for="inputError" [(ngModel)]="newAddress.phone" required appNumbers [ngClass]="{'has-value' : newAddress.phone}" (blur)="phoneBlur = true" (focus)="phoneBlur = false">
						 <label class="control-label" for="inputError">Mobile Number <span class="pl-1 text-danger">*</span></label>
						  <i class="fas fa-info-circle mobile-info-icon on-address" data-toggle="tooltip" data-placement="top" title="We will use this number to contact you at the time of delivery"></i>
						 <small *ngIf="myForm.controls.mobile.invalid && myForm.controls.mobile.touched" id="passwordHelpBlock" class="form-text text-danger">
							Please enter a valid Indian Mobile Number
						</small>
					</div>
				</div>					
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="form-group ">
						<textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="address" [(ngModel)]="newAddress.address" required [ngClass]="{'has-value' : newAddress.address}"></textarea>
						<label class="control-label">Address (House No, Building, Street, Area) <span class="pl-1 text-danger">*</span></label>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="form-group ">
						<input type="text" class="form-control form-control-lg" id="landmark" name="landmark" [(ngModel)]="newAddress.landmark" [ngClass]="{'has-value' : newAddress.landmark}">
						<label class="control-label">Landmark (Optional)</label>
					</div>
				</div>						
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="form-group ">
						<input class="form-control form-control-lg" id="pincode" type="tel"  minlength = "6" maxlength = "6" name="pincode" [(ngModel)]="newAddress.pincode" required appNumbers inputmode="numeric" [ngClass]="{'has-value' : newAddress.pincode}" (blur)="pincodeBlur = true" (focus)="pincodeBlur = false" (ngModelChange)="getCityState(newAddress.pincode)">
						<label class="control-label">Pincode <span class="pl-1 text-danger">*</span></label>
						<small class="form-text text-danger">
							<span *ngIf="pincodeBlur && newAddress.pincode.length != 6; else otherError">Please enter a valid 6 digit pincode</span>
							<ng-template #otherError><span>{{pincodeErrorMsg}}</span></ng-template>
						</small>

						<div *ngIf="pincodeWarning" class="align-items-center d-flex mt-2 text-black-50" style="font-size: 12px;">
							<small class="fa-stack mr-1">
								<i class="far fa-circle fa-stack-2x"></i>
								<i class="fa-info fa-stack-1x fas"></i>
							</small>
							{{pincodeWarning}}
						</div>
					</div>
				</div>
			</div>
			<div class="text-center d-none" [ngClass]="{'d-block': showPicodeLoader}" ><i class="fa-circle-notch fa-lg fa-spin fas text-primary"></i></div>
			<div class="row" *ngIf="newAddress.state_id && newAddress.city">
				<div class="col-md-6">
					<div class="form-group ">
						<input disabled class="form-control form-control-lg" id="citys" type="text" name="city" [(ngModel)]="newAddress.city" required [ngClass]="{'has-value' : newAddress.city}">
						<label class="control-label">Taluka/District <span class="pl-1 text-danger">*</span></label>
					</div>
				</div>
				<div class="col-md-6">
					<div class="form-group ">
						<input disabled class="form-control form-control-lg" id="state" type="text" name="state" required value="{{getStateName(newAddress.state_id)}}" [ngClass]="{'has-value' : newAddress.city}">
						<label class="control-label">State<span class="pl-1 text-danger">*</span></label>
					</div>					
				</div>
			</div>
			<div *ngIf="!hideDefaultAddressField && addresses.length" class="row mt-4 mb-3">
				<div class="col-md-12">
					<div class="custom-control custom-checkbox">
						<input type="checkbox" class="custom-control-input" id="customCheck1" name="default" [(ngModel)]="newAddress.default">
						<label class="custom-control-label font-weight-normal" for="customCheck1">Make this my default address</label>
					</div>
				</div>
			</div>
		</div>
		<div *ngIf="!hideUserFields && addAddress" class="d-block">
			<hr>
			<div class="">
				<h3 class="">Account Information</h3>
			</div>
			<p class="sub-text w-75 mt-3">We will be sending your order updates on the information provided below. This is a one time requirement. You can edit this information under your profile in My Account section.</p>
			<!-- <form #userInfo="ngForm"> -->
				<div class="form-group mb-0">
					<input type="email" class="form-control form-control-lg" id="frm-email" name="email" required [(ngModel)]="user.email" [ngClass]="{'has-value' : user.email}" pattern="[^ @]+@[^ @]+\.[^ @]+">
					<label class="control-label">Email Id <span class="pl-1 text-danger">*</span></label>
					<small *ngIf="myForm.controls.email.invalid && myForm.controls.email.touched" id="passwordHelpBlock" class="form-text text-danger">
							Please enter a valid Email ID
					</small>
				</div>
				<div class="form-group mb-0">
					<input type="text" class="form-control form-control-lg" id="frm-name" name="account_name" required [(ngModel)]="user.name" [disabled]="user.default" [ngClass]="{'has-value' : user.name}">
					<label class="control-label">Full Name <span class="pl-1 text-danger">*</span></label>			              
				</div>
			<!-- </form> -->
			<div class="row mt-4 mb-3">
				<div class="col-md-12">
					<div class="custom-control custom-checkbox">
						<input type="checkbox" class="custom-control-input" id="customCheck2" name="default" [(ngModel)]="user.default" (change)="copyUserName()">
						<label class="custom-control-label font-weight-normal" for="customCheck2">Same as my Shipping name</label>
					</div>
				</div>
			</div>
		</div>	
	</form>



	<div *ngIf="!addAddress && addresses" class="shipping-content-info mb-4" style="display: block;">
		<div class="radio-wrap d-flex kss_sizes wo-image mb-4">
			<div *ngFor="let address of addresses">
				<input class="d-none radio-input" type="radio" name="kss-address" id="address-{{address.id}}" [value]="address.id" [(ngModel)]="selectedAddressId" (change)="updatedAddAddress()">
				<label class="radio-label w-100 border-bottom text-left" for="address-{{address.id}}">
					<div class="radio-option d-flex align-items-start address-block">
						<div class="radio-selection position-relative" [ngClass]="{'d-none' : hideRadio}">
						 	<i class="fas fa-check-circle"></i>
						</div>
						<div class="text-left pl-2 flex-fill">
							<h3 class="kss-title font-weight-bold d-flex align-items-center w-100">{{address.name}} <span *ngIf="address.default" class="pl-2">(Default)  </span> <!-- <i class="fas fa-pencil-alt number-edit ml-2" (click)="editAddress(address)"></i> --></h3>

							<p class="w-75">
								{{address.address}}, {{address.city}}, {{getStateName(address.state_id)}} {{address.pincode}}
							</p>
							<p class="w-75">
								Mobile: <b class="font-weight-bold">{{address.phone}}</b>
							</p>
						</div>
						<div class="product-delete ml-2" title="Remove">
							<a (click)="deleteAddress(address.id)" class="cd-item-remove delete d-flex align-items-center justify-content-center text-center">
								<i class="far fa-trash-alt"></i>
							</a>
						</div>
					</div>
					<div class="order-tooltip tooltip-wrapper">
						<div class="tooltip-icon"><i class="fas fa-info-circle"></i></div>
						<div class="tooltip-msg">Verified address</div>
					</div>
				</label>
			</div>
		</div>
		<button type="button" id="add-address" class="btn kss-btn kss-btn--outline-secondary kss-btn--big" (click)="addNewAddress()">Add A New Address</button>
	</div>

	<div class="fixed-bottom d-block pl-3 pr-3">
		<div *ngIf="addAddress" class="row no-gutters px-2 py-2 shipping-state-1" style="display: flex;">
			<div class="col-6 text-center">
				<button [disabled]="!addresses.length" type="button" class="shipping-details-save btn kss-btn kss-btn--link kss-btn--big mt-1 mb-1 ml-auto mr-auto" (click)="updatedAddAddress()" >Cancel </button>
			</div>
			<div class="col-6 text-center">
				<button [disabled]="!myForm.valid || !(newAddress.state_id && newAddress.city)"  type="button" class="shipping-details-save btn kss-btn kss-btn--big mt-1 mb-1 ml-auto mr-auto" (click)="saveNewAddress(myForm)"> Save </button>
			</div>
		</div>
	</div>
</div>